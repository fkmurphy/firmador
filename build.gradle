plugins {
  id 'application'
    id 'java'
  id 'org.openjfx.javafxplugin' version '0.0.8'
    id 'org.beryx.jlink'               version '2.15.1'
    id 'com.github.ben-manes.versions' version '0.23.0'
}

repositories {
    mavenCentral()
    flatDir { dir 'lib' }
}

dependencies {
    implementation 'org.kordamp.ikonli:ikonli-javafx:11.1.0'
    implementation 'org.kordamp.ikonli:ikonli-fontawesome-pack:11.1.0'
    implementation 'org.kordamp.ikonli:ikonli-fontawesome5-pack:11.5.0'
    compile group: 'org.json', name: 'json', version: '20200518'
    compile group: 'jcifs', name: 'jcifs', version: '1.3.17'
    compile group: 'com.itextpdf', name: 'itextpdf', version: '5.5.3'
    compile 'org.bouncycastle:bcprov-jdk15on:1.56'
    compile 'org.bouncycastle:bcpkix-jdk15on:1.56'
}

mainClassName = 'org.openjfx.MainApp'

ext {
    appName = "HelloFX"
    appLauncher = "fxapp"
    appPackaging = "org.openjfx"
    appModuleName = "org.openjfx"
    appMainClass = "org.openjfx.MainApp"
}

run {
    args = [
            "firmador://192.168.42.25:8000/api?token=eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCV0N6NDNLbnEwUmRDVmF2RkVGc1l1S01FRzZGd0Z6eEpQZUhSSUdtSS00In0.eyJleHAiOjE2MDIxOTYxOTMsImlhdCI6MTYwMjE2MDE5MywianRpIjoiOThiZDcyZTQtNzNlNC00NmI3LWIxNDAtNWI0MTkxZGM0MzM2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguNDIuMjU6ODA4MC9hdXRoL3JlYWxtcy9JbnRlcm5vIiwiYXVkIjpbImZyb250ZW5kX3dvcmtmbG93IiwiYWNjb3VudCJdLCJzdWIiOiJiNzViOTE0My05NzBkLTQ0MTYtOGRhNy1hYWI5NDc2MmRhZjYiLCJ0eXAiOiJCZWFyZXIiLCJhenAiOiJhZG1pbi1jbGkiLCJzZXNzaW9uX3N0YXRlIjoiY2E3Y2E0NDEtOTA1NS00NDE3LTliNjYtN2E1YTI3OGUyODdiIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC40Mi4yNSIsImh0dHA6Ly8xMjcuMC4wLjEiLCIqIiwiaHR0cDovL2xvY2FsaG9zdDo0MjAwIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiZnJvbnRlbmRfd29ya2Zsb3ciOnsicm9sZXMiOlsiZnJvbnRlbmRfd29ya2Zsb3ciLCJtYW5hZ2VyX3NpdGUiLCJ1bWFfcHJvdGVjdGlvbiIsIm1hbmFnZXJfZG9jdW1lbnRhdGlvbiIsInNpZ25lciJdfSwiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsInZpZXctYXBwbGljYXRpb25zIiwidmlldy1jb25zZW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJtYW5hZ2UtY29uc2VudCIsInZpZXctcHJvZmlsZSJdfX0sInNjb3BlIjoiZW1haWwgQW5ndWxhclJvbGVzIGZyb250ZW5kX3JvbGVzIHBvc3RtYW5fcm9sZXMgcHJvZmlsZSBhZG1pbi1jbGkgZnJvbnRlbmRfd29ya2Zsb3ciLCJncm91cHNfbWVtYmVyIjpbXSwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJuYW1lIjoiTsOpc3RvciBKdWxpw6FuIE1VUlBIWSIsInByZWZlcnJlZF91c2VybmFtZSI6IjIwMzc2NzI4MDMwIiwiZ2l2ZW5fbmFtZSI6Ik7DqXN0b3IgSnVsacOhbiIsImZhbWlseV9uYW1lIjoiTVVSUEhZIiwiZW1haWwiOiJqbXVycGh5QHRyaWJjdWVudGFzcmlvbmVncm8uZ292LmFyIn0.foVLU_xHr-1y9Tef3m3g7yIakKeSYQ0cSxhmENGkA9lHy7rB8GFO5nJKzA_PtSON97GjwL2YWVbrhXd_S0nT7zYeYvWU-nk6Myp7w2aLzd4zE7SvM2JF8uIyXOHxO9BT3DSvWFnleP-gc5ub4HW7VVXr48scNwEcEY92ByyD4AqmuCmyLBMaXS7PK7mAANyBig9KUcr8d01_zWBYDKctdtHxNTVWzArqtlsD2sCNy0SZO6vs2P0RwRcBpimwAQ1f6RzVBLVVraJd6ZisDMHeYOf0nW3LKfSzfUd1FR_XNH_SvQdBCndUdLd5I3-ThrknmYymNQmxipsAiicz3h_LXw"
    ]
}

task dist {
    dependsOn clean, jlinkZip
    description "Calls clean and then jlinkZip [default]"
}
defaultTasks 'dist'
javafx {
    version = '13'
    modules = [
            'javafx.base',
            'javafx.fxml',
            'javafx.graphics',
            'javafx.controls'
    ]
}

jlink {
    imageZip = project.file("${buildDir}/distributions/${appPackaging}-${javafx.platform.classifier}.zip")
    launcher {
        name = 'hellofx'
    }

    options = ['--strip-debug', '--compress', '2',
               '--no-header-files', '--no-man-pages',
               '--output', "${appPackaging}"
    ]
}
/*jar {
    manifest {
        attributes(
                "Automatic-Module-Name": "jboss.jaxb.api.2.3.spec"
        )
    }
    from ('./src/main/java') {
        include 'META-INF/keycloak.json'
    }

}*/
allprojects {
    compileJava {
        options.forkOptions.javaHome = file(System.properties['java.home'])
    }

}
